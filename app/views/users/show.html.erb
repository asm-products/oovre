<% content_for(:title){ @user.name } %>

<div id="user-information" data-user-id="<%= @user.id %>" data-user-name="<%= @user.name %>"></div>

<div class="profile-header">
	<div class="cover-container">
		<% if @user.cover_image? %>
			<%= image_tag @user.cover_image.url, :class => 'cover' %>
		<% end %>
		<div class="cover-overlay"></div>
	</div>
	<div class="user">
		<div class="follow">
			<% if user_signed_in? %>
				<% if @user != current_user %>
					<div class="follow-group  <%= if current_user.following?(@user) then "is-following" else "not-following" end %>">
						<button id="following" class="button small primary following">Following <%= @user.first_name %></button>
						<button id="unfollow-user" data-user-id="<%= @user.id %>" class="button small alert unfollow">Unfollow <%= @user.first_name %></button>
						<button id="follow-user" data-user-id="<%= @user.id %>" class="button small success follow">Follow <%= @user.first_name %></button>
					</div>
				<% end %>
			<% end %>
		</div>
		<div class="info">
			<%= image_tag @user.avatar.url(:thumb), :class => 'avatar' %>
			<div class="name"><%= @user.name %></div>
			<div class="bio"><%= @user.bio if !@user.bio.blank? %></div>
		</div>
		<div class="stats">
			<div class="stat">
				<div class="num"><%= @user.articles.count rescue 0 %></div>
				<div class="name"><%= "article".pluralize(@user.articles.count) %></div>
			</div>
		  <div class="stat">
				<div class="num" id="follower-count"><%= @user.followers.count rescue 0 %></div>
				<div class="name"><%= "follower".pluralize(@user.followers.count) %></div>
			</div>
			<div class="stat">
				<div class="num"><%= @user.visit.unique_visits rescue 0 %></div>
				<div class="name">page <%= "view".pluralize(@user.visit.unique_visits) %></div>
			</div>
		</div>
	</div>
</div>

<div class="articles-container">
	<div class="articles">
		<% for article in @user.recent_articles(9) do %>
			<div class="article">
				<a href="<%= article_path(article) %>">
					<div class="article-container">
						<div class="background">
							<% if article.image? %>
								<%= image_tag article.image.url(:small) %>
							<% end %>
						</div>
						<div class="title"><%= article.title %></div>
						<div class="subtitle"><%= article.subtitle if !article.subtitle.blank? %></div>
						<% if article.article_set %>
							<%= link_to article.article_set.name, article_sets_path(article.article_set), class: 'article-set' %>
						<% end %>
					</div>
				</a>
			</div>
		<% end %>
	</div>
</div>